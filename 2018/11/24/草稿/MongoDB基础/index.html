<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		DB MOngo MongoDBåŸºç¡€ | 
	 
	coffee
	</title>
	
	<!-- keywords,description -->
	 

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/coffee/favicon.ico">
	
  

	
<link rel="stylesheet" href="/coffee/css/main.css">

	
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">


	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

	
<script src="/coffee/js/main.js"></script>

	
		
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>

		
<script src="https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js"></script>

	
	
<meta name="generator" content="Hexo 4.2.1"></head>

<body>
	<header id="header">
    <a id="title" href="/coffee/" class="logo">
        coffee
    </a>

    <ul id="menu">
        <li class="menu-item">
            <a href="/coffee/about" class="menu-item-link">ABOUT</a>
        </li>

        <!-- <li class="menu-item">
			<a href="https://github.com/wujun234/uid-generator-spring-boot-starter" class="menu-item-link" target="_blank">
				UidGenerator
			</a>
		</li> -->

        <li class="menu-item">
            <a href="https://github.com/likang00" class="menu-item-link" target="_blank">
                <i class="fa fa-github fa-2x"></i>
            </a>
        </li>
    </ul>
</header>
	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="text" placeholder="search...">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Pandas
									</a>
									
							<ul>
								<li class="file">
									<a href="/coffee/2020/07/03/Pandas/pandas-%E8%AF%BB%E5%86%99mysql/">
										pandas-è¯»å†™mysql
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/coffee/2020/06/15/Pandas/pandasql-%E5%9C%A8pandas%E4%B8%AD%E8%BF%90%E8%A1%8Csql/">
										pandasql-åœ¨pandasä¸­è¿è¡Œsql
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										SICP
									</a>
									
							<ul>
								<li class="file">
									<a href="/coffee/2020/06/30/SICP/SICP-01-%E6%9E%84%E9%80%A0%E8%BF%87%E7%A8%8B%E6%8A%BD%E8%B1%A1/">
										SICP-01-æ„é€ è¿‡ç¨‹æŠ½è±¡
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										è‰ç¨¿
									</a>
									
							<ul>
								<li class="file active">
									<a href="/coffee/2018/11/24/%E8%8D%89%E7%A8%BF/MongoDB%E5%9F%BA%E7%A1%80/">
										MongoDBåŸºç¡€
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- å¼•å…¥æ­£æ–‡ -->
	<div id="content">
		<h1 id="article-title">
    
        MongoDBåŸºç¡€
</h1>
<div class="article-meta">
    
        <span>
			é˜…è¯»é‡:<span id="/coffee/2018/11/24/%E8%8D%89%E7%A8%BF/MongoDB%E5%9F%BA%E7%A1%80/" class="leancloud_visitors" data-flag-title="DB MOngo MongoDBåŸºç¡€"></span>
        </span>
        
            <span>Likang</span>
            <span>2018-11-24 00:00:00</span>
            
                <div id="article-categories">
                    
                </div>
                
</div>

<div id="article-content">
    <h2 id="MongoDB-æ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ã€‚ç”±-C-è¯­è¨€ç¼–å†™ã€‚æ—¨åœ¨ä¸º-WEB-åº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚"><a href="#MongoDB-æ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ã€‚ç”±-C-è¯­è¨€ç¼–å†™ã€‚æ—¨åœ¨ä¸º-WEB-åº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚" class="headerlink" title="MongoDB æ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ã€‚ç”± C++ è¯­è¨€ç¼–å†™ã€‚æ—¨åœ¨ä¸º WEB åº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚"></a>MongoDB æ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ã€‚ç”± C++ è¯­è¨€ç¼–å†™ã€‚æ—¨åœ¨ä¸º WEB åº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚</h2><p>MongoDB å°†æ•°æ®å­˜å‚¨ä¸ºä¸€ä¸ªæ–‡æ¡£ï¼Œæ•°æ®ç»“æ„ç”±é”®å€¼(key=&gt;value)å¯¹ç»„æˆã€‚MongoDB æ–‡æ¡£ç±»ä¼¼äº JSON å¯¹è±¡ã€‚å­—æ®µå€¼å¯ä»¥åŒ…å«å…¶ä»–æ–‡æ¡£ï¼Œæ•°ç»„åŠæ–‡æ¡£æ•°ç»„ã€‚</p>
<a id="more"></a>
<p><img src="/coffee/2018/11/24/%E8%8D%89%E7%A8%BF/MongoDB%E5%9F%BA%E7%A1%80/mongodb.png" alt="MongoDB"></p>
<h1 id="0-æ•°æ®åº“å¯åŠ¨-å…³é—­-ğŸ•"><a href="#0-æ•°æ®åº“å¯åŠ¨-å…³é—­-ğŸ•" class="headerlink" title="0.æ•°æ®åº“å¯åŠ¨/å…³é—­ ğŸ•"></a>0.æ•°æ®åº“å¯åŠ¨/å…³é—­ ğŸ•</h1><p>å¯åŠ¨mongonDB:<br>C:\mongo\mongodb\bin &gt;&gt;</p>
<pre><code class="shell">mongod --dbpath C:\mongo\mongodb\data\db
mongod --dbpath C:\mongo\mongodb\data\db --repair # å¼‚å¸¸å…³é—­æ—¶é‡å¯</code></pre>
<p>å…³é—­mongodb:<br>mongo_shell &gt;&gt;</p>
<pre><code>use admin
db.shutdownServer()</code></pre><hr>
<h1 id="1-æ•°æ®åº“çš„å¯¼å…¥å’Œå¯¼å‡º-ğŸ”"><a href="#1-æ•°æ®åº“çš„å¯¼å…¥å’Œå¯¼å‡º-ğŸ”" class="headerlink" title="1.æ•°æ®åº“çš„å¯¼å…¥å’Œå¯¼å‡º ğŸ”"></a>1.æ•°æ®åº“çš„å¯¼å…¥å’Œå¯¼å‡º ğŸ”</h1><pre><code class="shell">æœ¬åœ°:127.0.0.1:27017
çº¿ä¸Š:xxx.xxx.xx.xxx:xxxxx-u xxxx -p xxxxxxxx

**BSON**
bsonæ ¼å¼å¯¼å‡º
mongodump -h 127.0.0.1:27017 -d xxxx -c xxxx -o ./
mongodump -h xxx.xxx.xx.xxx:xxxx -d xxxx -c xxxx -u xxxx -p xxxxxxxx -o ./
bsonæ ¼å¼å¯¼å…¥
mongorestore -h xxx.xxx.xx.xxx:xxxx -d xxxx --dir F:\xxxx -u xxxx -p xxxxxxxx
mongorestore -h 127.0.0.1:27017 -d xxxx--dir F:\xxxx\xxxx

**JSON**
jsonæ ¼å¼å¯¼å‡º
mongoexport -h xxx.xxx.xx.xxx:xxxx -d xxxx-c xxxx -u xxxx -p xxxxxxxx --out name.json
jsonæ ¼å¼å¯¼å…¥
mongoimport -h xxx.xxx.xx.xxx:xxxx -d xxxx -c xxxx --file name.json -u xxxx -p xxxxxxxx
mongoimport -h xxx.xxx.xx.xxx:xxxx -d xxxx -c xxxx (--drop) --file name.json -u xxxx -p xxxxxxxx</code></pre>
<hr>
<h1 id="2-æ›´æ–°å’Œåˆ é™¤-å­—æ®µ-ğŸŸ"><a href="#2-æ›´æ–°å’Œåˆ é™¤-å­—æ®µ-ğŸŸ" class="headerlink" title="2.æ›´æ–°å’Œåˆ é™¤ å­—æ®µ ğŸŸ"></a>2.æ›´æ–°å’Œåˆ é™¤ å­—æ®µ ğŸŸ</h1><p><strong>ä¿®æ”¹</strong> å­—æ®µå</p>
<pre><code class="js">db.getCollection(&#39;pydb&#39;).update({}, {$rename : {&quot;pop&quot; : &quot;abc&quot;}}, false, true)
db.getCollection(&#39;SS_UniversityInfo&#39;).update({}, {$rename : {&quot;XuanKaoScrope&quot; : &quot;SubjectScope&quot;}}, false, true)</code></pre>
<p>å‚æ•°è¯´æ˜ï¼š<br>db.collection.update(criteria,objNew,upsert,multi)<br><strong>criteria</strong> ï¼šæŸ¥è¯¢æ¡ä»¶<br><strong>objNew</strong> ï¼šupdateå¯¹è±¡å’Œä¸€äº›æ›´æ–°æ“ä½œç¬¦<br><strong>upsert</strong> ï¼šå¦‚æœä¸å­˜åœ¨updateçš„è®°å½•ï¼Œæ˜¯å¦æ’å…¥objNewè¿™ä¸ªæ–°çš„æ–‡æ¡£ï¼Œtrueä¸ºæ’å…¥ï¼Œé»˜è®¤ä¸ºfalseï¼Œä¸æ’å…¥ã€‚<br><strong>multi</strong> ï¼šé»˜è®¤æ˜¯falseï¼Œåªæ›´æ–°æ‰¾åˆ°çš„ç¬¬ä¸€æ¡è®°å½•ã€‚å¦‚æœä¸ºtrueï¼ŒæŠŠæŒ‰æ¡ä»¶æŸ¥è¯¢å‡ºæ¥çš„è®°å½•å…¨éƒ¨æ›´æ–°</p>
<p><strong>æ›´æ–°</strong> å­—æ®µ</p>
<pre><code class="js">db.table.update({}, {$set: {content:&quot;xxx&quot;}}, false,true)</code></pre>
<p><strong>åˆ é™¤</strong> å­—æ®µ</p>
<pre><code class="js">db.table.update({},{$unset:{content:&quot;&quot;}},false, true)</code></pre>
<hr>
<h2 id="ç»ƒä¹ -ğŸ¤"><a href="#ç»ƒä¹ -ğŸ¤" class="headerlink" title="ç»ƒä¹  ğŸ¤"></a>ç»ƒä¹  ğŸ¤</h2><ul>
<li>ä¿®æ”¹åˆ—è¡¨é‡Œçš„å­—å…¸é‡Œçš„å­—æ®µå</li>
</ul>
<pre><code class="js">// æŠŠXuanKaoSubjectScrope å­—æ®µæ”¹æˆ Scrope
[
    {
        &quot;SubjectScope&quot;:[
            {&quot;XuanKaoSubjectScrope&quot;:&quot;x1&quot;},
            {&quot;XuanKaoSubjectScrope&quot;:&quot;x2&quot;},
            {&quot;XuanKaoSubjectScrope&quot;:&quot;x3&quot;},
        ]
    },
    {},
    {}...
]</code></pre>
<pre><code class="js">// [æœªå®Œç¾è§£å†³] å½“æ—¶é‡‡ç”¨çš„æ–¹æ³•æ˜¯å¯¼å‡ºjsonå†æ›¿æ¢æ–‡æœ¬ğŸ˜‚
db.getCollection(&#39;SS_UniversityInfo&#39;).update(
    {&quot;SubjectScope&quot;:{
        &quot;$elemMatch&quot;:{
            &quot;XuanKaoSubjectScrope&quot;:{
                &quot;$exists&quot;:true}}}},
    {&quot;$rename&quot;:{
        &quot;$SubjectScope.$.XuanKaoSubjectScrope&quot;:&quot;SubjectScope.$.Scrope&quot;}
        },
    false,
    true)</code></pre>
<pre><code class="js">// ç°åœ¨å‘ç°å¯ä»¥å†™pythonæˆ–jsè„šæœ¬è§£å†³</code></pre>
<hr>
<ul>
<li>æ­£åˆ™å¯»æ‰¾ä¸ä»¥cn/com/org/net/hk/eduç»“å°¾çš„å­—æ®µ</li>
</ul>
<pre><code class="js">db.getCollection(&#39;SS_UniversityInfo&#39;).find({&quot;WebSite&quot;:{&quot;$not&quot;:/cn$|com$|org$|net$|hk$|edu$/}})

db.getCollection(&#39;SS_UniversityInfo&#39;).find({&quot;WebSite&quot;:{&quot;$regex&quot;:&quot;net$|com$&quot;}})</code></pre>
<ul>
<li><a href="https://blog.csdn.net/yaomingyang/article/details/75103480" target="_blank" rel="noopener">MongoDBé€»è¾‘æ“ä½œç¬¦$or, $and,$not,$nor</a></li>
</ul>
<hr>
<h1 id="3-MogoDB-èšåˆ-ğŸ³"><a href="#3-MogoDB-èšåˆ-ğŸ³" class="headerlink" title="3.MogoDB èšåˆ ğŸ³"></a>3.MogoDB èšåˆ ğŸ³</h1><ul>
<li><a href="http://www.runoob.com/mongodb/mongodb-aggregate.html" target="_blank" rel="noopener">èœé¸Ÿæ•™ç¨‹ MongoDB èšåˆ</a></li>
</ul>
<p>ç®¡é“åœ¨Unixå’ŒLinuxä¸­ä¸€èˆ¬ç”¨äºå°†å½“å‰å‘½ä»¤çš„ <strong>è¾“å‡ºç»“æœ</strong> ä½œä¸ºä¸‹ä¸€ä¸ªå‘½ä»¤çš„ <strong>å‚æ•°</strong> ã€‚<br>MongoDBçš„èšåˆç®¡é“å°†MongoDBæ–‡æ¡£åœ¨ä¸€ä¸ªç®¡é“å¤„ç†å®Œæ¯•åå°†ç»“æœ<strong>ä¼ é€’</strong>ç»™ä¸‹ä¸€ä¸ªç®¡é“å¤„ç†ã€‚<br>ç®¡é“æ“ä½œæ˜¯å¯ä»¥<strong>é‡å¤</strong>çš„ã€‚</p>
<p>ç®€å•ä»‹ç»ä¸€ä¸‹èšåˆä¸­å¸¸ç”¨çš„å‡ ä¸ªå‚æ•°ï¼š</p>
<pre><code class="py">$projectï¼šä¿®æ”¹è¾“å…¥æ–‡æ¡£çš„ç»“æ„ã€‚å¯ä»¥ç”¨æ¥é‡å‘½åã€å¢åŠ æˆ–åˆ é™¤åŸŸï¼Œä¹Ÿå¯ä»¥ç”¨äºåˆ›å»ºè®¡ç®—ç»“æœä»¥åŠåµŒå¥—æ–‡æ¡£ã€‚
$matchï¼šç”¨äºè¿‡æ»¤æ•°æ®ï¼Œåªè¾“å‡ºç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£ã€‚$matchä½¿ç”¨MongoDBçš„æ ‡å‡†æŸ¥è¯¢æ“ä½œã€‚
$limitï¼šç”¨æ¥é™åˆ¶MongoDBèšåˆç®¡é“è¿”å›çš„æ–‡æ¡£æ•°ã€‚
$skipï¼šåœ¨èšåˆç®¡é“ä¸­è·³è¿‡æŒ‡å®šæ•°é‡çš„æ–‡æ¡£ï¼Œå¹¶è¿”å›ä½™ä¸‹çš„æ–‡æ¡£ã€‚
$unwindï¼šå°†æ–‡æ¡£ä¸­çš„æŸä¸€ä¸ªæ•°ç»„ç±»å‹å­—æ®µæ‹†åˆ†æˆå¤šæ¡ï¼Œæ¯æ¡åŒ…å«æ•°ç»„ä¸­çš„ä¸€ä¸ªå€¼ã€‚
$groupï¼šå°†é›†åˆä¸­çš„æ–‡æ¡£åˆ†ç»„ï¼Œå¯ç”¨äºç»Ÿè®¡ç»“æœã€‚
$sortï¼šå°†è¾“å…¥æ–‡æ¡£æ’åºåè¾“å‡ºã€‚
$geoNearï¼šè¾“å‡ºæ¥è¿‘æŸä¸€åœ°ç†ä½ç½®çš„æœ‰åºæ–‡æ¡£</code></pre>

</div>


    <div class="post-guide">
        <div class="item left">
            
                <a href="/coffee/2020/06/15/Pandas/pandasql-%E5%9C%A8pandas%E4%B8%AD%E8%BF%90%E8%A1%8Csql/">
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    pandasql-åœ¨pandasä¸­è¿è¡Œsql
                </a>
                
        </div>
        <div class="item right">
            
        </div>
    </div>
    

        
            <div id="vcomments"></div>
            

                <script>
                    
                    // è¯„è®º
                    new Valine({
                        av: AV,
                        el: '#vcomments',
                        notify: false,
                        verify: false,
                        path: window.location.pathname,
                        appId: 'tJxJnGBThP2QREi51YKLnAEi-gzGzoHsz',
                        appKey: '0mOvE5Ttyj7hkC5QLMpQLRVk',
                        placeholder: 'è¯·è¾“å…¥è¯„è®º',
                        avatar: 'retro',
                        recordIP: false
                    })
                    
                    
                    // æ˜¾ç¤ºæ¬¡æ•°
                    function showTime(Counter) {
                        var query = new AV.Query("Counter");
                        if ($(".leancloud_visitors").length > 0) {
                            var url = $(".leancloud_visitors").attr('id').trim();
                            // where field
                            query.equalTo("words", url);
                            // count
                            query.count().then(function(number) {
                                // There are number instances of MyClass where words equals url.
                                $(document.getElementById(url)).text(number ? number : '--');
                            }, function(error) {
                                // error is an instance of AVError.
                            });
                        }
                    }
                    // è¿½åŠ pv
                    function addCount(Counter) {
                        var url = $(".leancloud_visitors").length > 0 ? $(".leancloud_visitors").attr('id').trim() : 'wujun234.github.io';
                        var Counter = AV.Object.extend("Counter");
                        var query = new Counter;
                        query.save({
                            words: url
                        }).then(function(object) {})
                    }
                    $(function() {
                        var Counter = AV.Object.extend("Counter");
                        addCount(Counter);
                        showTime(Counter);
                    });
                    
                </script>
	</div>
	<div id="footer">
	<p>
	Â©2019-<span id="footerYear"></span> 
	<a href="/">Likang</a> 
	
	
	<br>
	Theme <a href="//github.com/wujun234/hexo-theme-tree" target="_blank">Tree</a>
	by <a href="//github.com/wujun234" target="_blank">WuJun</a>
	Powered by <a href="//hexo.io" target="_blank">Hexo</a>
	</p>
</div>
<script type="text/javascript"> 
	document.getElementById('footerYear').innerHTML = new Date().getFullYear() + '';
</script>
	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>